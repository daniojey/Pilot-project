{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}">   

<head align="center">
    <h1 align="center">
        {{ test.name }}
    </h1>
</head>

<body>
    <div id="timer" align='right'></div>
    
    <form id="test-form" method="post" align="left">
        {% csrf_token %}
        {% for field in form %}
        {% if 'question_' in field.name %}
            {% with question_id=field.name|cut:'question_' %}
                {% for quest in question %}
                    {% if question_id|add:0 == quest.id %}
                        <img src="{{ quest.image.url }}" alt="{{ quest.text }}" >
                    {% endif %}
                {% endfor %}
            {% endwith %}
        {% endif %}
            <div class="form-group">
                {{ field.label_tag }}
                {{ field }}
            </div>
        {% endfor %}
        <button type="submit" >Завершить тест</button>
    </form>
</body>


<script>
    var countDownDuration = parseInt("{{ test.duration.total_seconds }}", 10) * 1000;

    if (isNaN(countDownDuration)) {
        console.error("Invalid duration:", "{{ test.duration.total_seconds }}");
    } else {
        var timer = setInterval(function() {
            if (countDownDuration <= 0) {
                clearInterval(timer);
                window.location.href = "{% url 'tests:test_results' test.id %}";
            }
            var hours = Math.floor((countDownDuration % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((countDownDuration % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((countDownDuration % (1000 * 60)) / 1000);
            
            var display = hours > 0 ? hours + "h " : "";
            display += minutes + "m " + seconds + "s ";

            document.getElementById('timer').innerText = display;
            countDownDuration -= 1000;
        }, 1000);
    }



</script>







